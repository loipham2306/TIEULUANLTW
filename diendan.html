<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diễn Đàn - QUIZ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50 min-h-screen flex flex-col font-sans text-slate-800">
    <header class="bg-blue-600 shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                
                <!-- Desktop Menu -->
                <nav class="hidden md:flex space-x-6">
                    <a href="index.html" class="px-4 py-2 rounded-lg text-white font-medium hover:bg-blue-800 transition">TRANG CHỦ</a>
                    <a href="tintuc.html" class="px-4 py-2 rounded-lg text-white font-medium hover:bg-blue-800 transition">TIN TỨC</a>
                    <a href="diendan.html" class="px-4 py-2 rounded-lg text-yellow-300 bg-blue-800 font-bold shadow-inner">DIỄN ĐÀN</a>
                    <a href="gioithieu.html" class="px-4 py-2 rounded-lg text-white font-medium hover:bg-blue-800 transition">GIỚI THIỆU</a>
                </nav>

                <button id="btnMenuMobile" class="md:hidden text-white focus:outline-none p-2">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>
                
                <div class="flex items-center space-x-2">
                    <h1 class="text-3xl font-extrabold text-yellow-300 tracking-wider drop-shadow-md">QUIZ LẬP TRÌNH</h1>
                </div>    
            </div>
        </div>

        <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-blue-700 absolute w-full left-0 z-50 shadow-lg transition-all duration-300">
            <div class="flex flex-col p-4 space-y-2">
                <a href="index.html" class="block py-2 px-4 text-gray-600 hover:bg-blue-50 rounded-lg">TRANG CHỦ</a>
                <a href="tintuc.html"  class="block py-2 px-4 text-gray-600 hover:bg-blue-50 rounded-lg">TIN TỨC</a>
                <a href="diendan.html" class="block py-2 px-4 text-blue-700 font-bold bg-blue-50 rounded-lg">DIỄN ĐÀN</a>
                <a href="gioithieu.html" class="block py-2 px-4 text-gray-600 hover:bg-blue-50 rounded-lg">GIỚI THIỆU</a>
            </div>
        </div>
    </header>
    <main class="flex-grow container mx-auto px-4 py-12 max-w-4xl">
        <div class="text-center mb-10">
            <h2 class="text-3xl font-bold text-slate-800">Góc Thảo Luận</h2>
            <div class="h-1 w-20 bg-blue-600 mx-auto rounded-full mt-2"></div>
        </div>

        <div id="forumAuth" class="bg-white p-6 rounded-xl shadow-md border-l-4 border-blue-600 mb-8 flex flex-col md:flex-row justify-between items-center gap-4">
        
        </div>

 
        <div class="bg-white p-6 rounded-xl shadow-md">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-100">
                <h3 class="text-xl font-bold text-slate-700"><i class="fa-regular fa-comments mr-2"></i>Các ý kiến đóng góp</h3>
                <button onclick="toggleCommentForm()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition shadow-sm font-medium">
                    <i class="fa-solid fa-pen mr-2"></i> Viết Góp Ý
                </button>
            </div>


            <div id="commentForm" class="hidden mb-8 bg-slate-50 p-4 rounded-xl border border-slate-200">
                <label class="block text-sm font-bold text-slate-600 mb-2">Nội dung góp ý:</label>
                <textarea id="commentContent" class="w-full p-3 border rounded-lg focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 bg-white" rows="3" placeholder="Chia sẻ ý kiến của bạn..."></textarea>
                <div class="mt-3 text-right">
                    <button onclick="document.getElementById('commentForm').classList.add('hidden')" class="text-slate-500 px-4 py-2 hover:text-slate-700 mr-2">Hủy</button>
                    <button onclick="postComment()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 font-bold shadow-md">Gửi ngay</button>
                </div>
            </div>

     
            <div id="commentList" class="space-y-4">
           
            </div>
        </div>
    </main>

    <div id="loginModal" class="hidden fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full modal-animate relative">
            <button onclick="closeModal('loginModal')" class="absolute top-4 right-4 text-gray-400 hover:text-red-500"><i class="fa-solid fa-times text-xl"></i></button>
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl"><i class="fa-solid fa-right-to-bracket"></i></div>
                <h2 class="text-2xl font-bold text-slate-800">Đăng Nhập</h2>
            </div>
            <input type="text" id="loginUser" placeholder="Tên đăng nhập" class="w-full p-3 border rounded-lg mb-4 focus:border-blue-500 outline-none">
            <input type="password" id="loginPass" placeholder="Mật khẩu" class="w-full p-3 border rounded-lg mb-6 focus:border-blue-500 outline-none">
            <button onclick="handleLogin()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 shadow-lg shadow-blue-200">Đăng Nhập</button>
            <p class="mt-4 text-center text-sm text-gray-500">Chưa có tài khoản? <span onclick="switchModal('loginModal', 'registerModal')" class="text-blue-600 font-bold cursor-pointer hover:underline">Đăng ký ngay</span></p>
        </div>
    </div>


    <div id="registerModal" class="hidden fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full modal-animate relative">
            <button onclick="closeModal('registerModal')" class="absolute top-4 right-4 text-gray-400 hover:text-red-500"><i class="fa-solid fa-times text-xl"></i></button>
            <div class="text-center mb-2">
                <div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl"><i class="fa-solid fa-user-plus"></i></div>
                <h2 class="text-2xl font-bold text-slate-800">Đăng Ký</h2>
            </div>
            <p class="text-xs text-gray-500 mb-6 text-center bg-gray-50 p-2 rounded border border-gray-200">
                Mật khẩu: 6-20 ký tự (Hoa, thường, số, ký tự đặc biệt, không dấu/cách).
            </p>
            
            <input type="text" id="regUser" placeholder="Tên đăng nhập mới" class="w-full p-3 border rounded-lg mb-4 focus:border-green-500 outline-none">
            <input type="password" id="regPass" placeholder="Mật khẩu" class="w-full p-3 border rounded-lg mb-6 focus:border-green-500 outline-none">
            
            <button onclick="handleRegister()" class="w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 shadow-lg shadow-green-200">Đăng Ký</button>
            <p class="mt-4 text-center text-sm text-gray-500">Đã có tài khoản? <span onclick="switchModal('registerModal', 'loginModal')" class="text-blue-600 font-bold cursor-pointer hover:underline">Đăng nhập</span></p>
        </div>
    </div>

    <footer class="bg-slate-900 text-white py-8 mt-auto">
        <div class="container mx-auto px-4 text-center">
  <p class="text-slate-400 text-sm">&copy; 2025 QUIZ. Designed by Pham Huu Loi.</p>
        </div>
    </footer>

 
    <script>
      
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let comments = JSON.parse(localStorage.getItem('comments')) || [];
        let currentUser = localStorage.getItem('currentUser');

    
        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function switchModal(closeId, openId) { closeModal(closeId); openModal(openId); }

   
        function checkLoginState() {
            const authDiv = document.getElementById('forumAuth');
            
            if (currentUser) {
            
                authDiv.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-xl">
                            ${currentUser.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Xin chào,</p>
                            <p class="font-bold text-lg text-blue-700">${currentUser}</p>
                        </div>
                    </div>
                    <button onclick="handleLogout()" class="border border-red-200 text-red-500 px-4 py-2 rounded-lg hover:bg-red-50 transition text-sm font-bold">
                        <i class="fa-solid fa-right-from-bracket mr-2"></i>Đăng xuất
                    </button>
                `;
            } else {
              
                authDiv.innerHTML = `
                    <div class="text-gray-600">
                        <p class="font-bold text-lg">Bạn chưa đăng nhập?</p>
                        <p class="text-sm">Hãy đăng nhập để tham gia thảo luận cùng cộng đồng.</p>
                    </div>
                    <div class="flex gap-3 mt-4 md:mt-0">
                        <button onclick="openModal('loginModal')" class="bg-white border border-blue-600 text-blue-600 px-6 py-2.5 rounded-lg font-bold hover:bg-blue-50 transition">Đăng Nhập</button>
                        <button onclick="openModal('registerModal')" class="bg-blue-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-blue-700 shadow-md transition">Đăng Ký</button>
                    </div>
                `;
            }
        }


        function handleRegister() {
            const u = document.getElementById('regUser').value.trim();
            const p = document.getElementById('regPass').value;

            if (!u || !p) return alert("Vui lòng nhập đầy đủ!");
            if (users.find(user => user.username === u)) return alert("Tên đăng nhập đã tồn tại!");

            const passRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,20}$/;

            if (!passRegex.test(p)) {
                alert("Mật khẩu không đạt yêu cầu!\n- 6-20 ký tự.\n- Phải có: Hoa, thường, số, ký tự đặc biệt.\n- Không dấu, không khoảng cách.");
                return;
            }

            users.push({ username: u, password: p });
            localStorage.setItem('users', JSON.stringify(users));
            alert("Đăng ký thành công! Hãy đăng nhập.");
            switchModal('registerModal', 'loginModal');
            
  
            document.getElementById('regUser').value = "";
            document.getElementById('regPass').value = "";
        }


        function handleLogin() {
            const u = document.getElementById('loginUser').value.trim();
            const p = document.getElementById('loginPass').value;
            const user = users.find(user => user.username === u && user.password === p);

            if (user) {
                currentUser = u;
                localStorage.setItem('currentUser', u);
                checkLoginState();

            } else {
                alert("Sai tên đăng nhập hoặc mật khẩu!");
            }
        }


        function handleLogout() {
            if(confirm("Bạn có chắc muốn đăng xuất?")) {
                currentUser = null;
                localStorage.removeItem('currentUser');
                checkLoginState();
            }
        }

 
        function toggleCommentForm() {
            if (!currentUser) return alert("Vui lòng đăng nhập để viết góp ý!");
            document.getElementById('commentForm').classList.remove('hidden');
        }

        function postComment() {
            const content = document.getElementById('commentContent').value.trim();
            if (!content) return alert("Bạn chưa nhập nội dung!");

            comments.unshift({
                user: currentUser,
                text: content,
                time: new Date().toLocaleString()
            });
            
            localStorage.setItem('comments', JSON.stringify(comments));
            document.getElementById('commentContent').value = "";
            document.getElementById('commentForm').classList.add('hidden');
            renderComments();
        }

        function renderComments() {
            const list = document.getElementById('commentList');
            if (comments.length === 0) {
                list.innerHTML = '<p class="text-center text-gray-400 italic py-4">Chưa có góp ý nào. Hãy là người đầu tiên!</p>';
                return;
            }

            list.innerHTML = comments.map(cmt => `
                <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex gap-4 transition hover:bg-gray-50">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 text-white rounded-full flex items-center justify-center font-bold shrink-0 shadow-md">
                        ${cmt.user.charAt(0).toUpperCase()}
                    </div>
                    <div class="flex-grow">
                        <div class="flex justify-between items-center mb-1">
                            <h4 class="font-bold text-slate-800 text-sm">${cmt.user}</h4>
                            <span class="text-[10px] text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full">${cmt.time}</span>
                        </div>
                        <p class="text-slate-600 text-sm leading-relaxed">${cmt.text}</p>
                    </div>
                </div>
            `).join('');
        }
        document.addEventListener('DOMContentLoaded', function() {
            const btn = document.getElementById('btnMenuMobile');
            const menu = document.getElementById('mobileMenu');
            
            if (btn && menu) {
                btn.addEventListener('click', function() {
                    menu.classList.toggle('hidden');
                });
            }
        });
        checkLoginState();
        renderComments();
    </script>
</body>
</html>